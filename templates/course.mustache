{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.

    RemUI Kids - Child theme of RemUI
    @package theme_remui_kids
    @copyright (c) 2025 Kodeit
    @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
}}
{{!
    @template theme_remui_kids/course

    Kids-friendly course template with Learning Modules card layout.
}}
{{> theme_remui/common_start}}

<!-- Learning Modules CSS -->
<link rel="stylesheet" href="{{config.wwwroot}}/theme/remui_kids/style/learning-modules.css?v={{timestamp}}">

<!-- Learning Modules JavaScript -->
<script src="{{config.wwwroot}}/theme/remui_kids/js/learning-modules.js?v={{timestamp}}"></script>

<div id="page-content" class="pb-4 d-print-block">
    <div id="region-main-box">
        {{#hasregionmainsettingsmenu}}
        <div id="region-main-settings-menu" class="d-print-none">
            <div> {{{ regionmainsettingsmenu }}} </div>
        </div>
        {{/hasregionmainsettingsmenu}}
        <section id="region-main" aria-label="{{#str}}content{{/str}}">
            {{#hasregionmainsettingsmenu}}
                <div class="region_main_settings_menu_proxy"></div>
            {{/hasregionmainsettingsmenu}}
            {{{ output.course_content_header }}}
            {{#headercontent}}
                {{> core/activity_header }}
            {{/headercontent}}
            {{#overflow}}
                <div class="container-fluid tertiary-navigation">
                    <div class="navitem">
                        {{> core/url_select}}
                    </div>
                </div>
            {{/overflow}}

            {{#custom_section_view}}
            <!-- Professional Section Activities View -->
            <div class="professional-section-activities">
                <!-- Course Navigation Sidebar -->
                <div class="course-navigation-sidebar">
                    <div class="sidebar-header">
                        <div class="sidebar-controls">
                            <button class="sidebar-back-btn" onclick="goBackToCourse()">
                                <i class="fa fa-home" aria-hidden="true"></i>
                                <span>Course Home</span>
                            </button>
                            <h3 class="sidebar-title">COURSE PATHWAY</h3>
                            <button class="sidebar-collapse-btn" onclick="collapseSidebar()">
                                <i class="fa fa-compress" aria-hidden="true"></i>
                                <span>Collapse</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="course-sections-navigation">
                        {{#course_sections}}
                        <div class="section-navigation-item {{#is_current}}current{{/is_current}}">
                            <div class="section-header" onclick="toggleSection({{section}})">
                                <div class="section-indicator">
                                    <div class="section-number">{{section}}</div>
                                    <div class="section-status">
                                        {{#is_completed}}
                                        <i class="fa fa-check-circle completed" aria-hidden="true"></i>
                                        {{/is_completed}}
                                        {{^is_completed}}
                                            {{#has_started}}
                                            <i class="fa fa-play-circle in-progress" aria-hidden="true"></i>
                                            {{/has_started}}
                                            {{^has_started}}
                                            <i class="fa fa-circle-o not-started" aria-hidden="true"></i>
                                            {{/has_started}}
                                        {{/is_completed}}
                                    </div>
                                </div>
                                
                                <div class="section-info">
                                    <a href="{{{url}}}" class="section-link">
                                        <span class="section-name">{{name}}</span>
                                        <div class="section-meta">
                                            <span class="section-progress">{{progress}}% Complete</span>
                                            <span class="section-activities-count">{{completed_activities}}/{{total_activities}} Activities</span>
                                        </div>
                                    </a>
                                    <button class="section-expand-btn" onclick="toggleSection({{section}})">
                                        <i class="fa fa-chevron-down" aria-hidden="true"></i>
                                    </button>
                                        </div>
                                    </div>
                            
                            <div class="section-activities-list" id="section-{{section}}-activities">
                                {{#activities}}
                                <div class="activity-navigation-item {{#is_completed}}completed{{/is_completed}}{{^is_completed}}{{#has_started}}in-progress{{/has_started}}{{^has_started}}not-started{{/has_started}}{{/is_completed}}">
                                    <div class="activity-status-indicator">
                                        {{#is_completed}}
                                        <i class="fa fa-check-circle" aria-hidden="true"></i>
                                        {{/is_completed}}
                                        {{^is_completed}}
                                            {{#has_started}}
                                            <i class="fa fa-play-circle" aria-hidden="true"></i>
                                            {{/has_started}}
                                            {{^has_started}}
                                            <i class="fa fa-circle-o" aria-hidden="true"></i>
                                            {{/has_started}}
                                        {{/is_completed}}
                                    </div>
                                    
                                    <a href="{{{url}}}" class="activity-link">
                                        <div class="activity-icon">
                                            <i class="fa fa-file-text" aria-hidden="true"></i>
                                        </div>
                                        <div class="activity-details">
                                            <span class="activity-name">{{name}}</span>
                                            <span class="activity-duration">{{modname}}</span>
                                        </div>
                                    </a>
                                    
                                    <div class="activity-connector-line"></div>
                                </div>
                                {{/activities}}
                            </div>
                        </div>
                        {{/course_sections}}
                    </div>
                </div>
                
                <!-- Main Content Area -->
                <div class="activities-main-content">
                    <div class="activities-content-header">
                        <div class="breadcrumb-navigation">
                            <a href="{{{course_url}}}" class="breadcrumb-item">
                                <i class="fa fa-home" aria-hidden="true"></i>
                                <span>Course Home</span>
                            </a>
                            <i class="fa fa-chevron-right" aria-hidden="true"></i>
                            <span class="breadcrumb-current">Unit {{current_section}}: {{section_activities.section_name}}</span>
            </div>

                        <div class="activities-title-section">
                            <h1 class="activities-main-title">Unit {{current_section}}: {{section_activities.section_name}}</h1>
                            <p class="activities-subtitle">Complete these activities to master this section</p>
                            
                            <div class="section-progress-overview">
                                <div class="progress-stats">
                                    <div class="stat-item">
                                        <span class="stat-number">{{section_activities.section_progress}}%</span>
                                        <span class="stat-label">Complete</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-number">{{section_activities.completed_activities}}</span>
                                        <span class="stat-label">Completed</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-number">{{section_activities.total_activities}}</span>
                                        <span class="stat-label">Total Activities</span>
                                    </div>
                                </div>
                                <div class="section-progress-bar">
                                    <div class="progress-track">
                                        <div class="progress-fill" style="width: {{section_activities.section_progress}}%"></div>
                                    </div>
                                </div>
                            </div>
            </div>
                    </div>
                    
                    <div class="activities-table-section">
                        <div class="table-header">
                            <h2>Learning Modules</h2>
                            
                            <div class="table-controls">
                                <div class="view-options">
                                    <button class="view-btn active" data-view="grid" onclick="changeActivitiesView('grid')">
                                        <i class="fa fa-th" aria-hidden="true"></i>
                                        <span>Grid</span>
                                    </button>
                                    <button class="view-btn" data-view="list" onclick="changeActivitiesView('list')">
                                        <i class="fa fa-list" aria-hidden="true"></i>
                                        <span>List</span>
                                    </button>
                                </div>
                                
                                <div class="filter-controls">
                                    <div class="filter-dropdown">
                                        <button class="filter-btn">
                                            <i class="fa fa-filter" aria-hidden="true"></i>
                                            <span>Filter</span>
                                            <i class="fa fa-chevron-down" aria-hidden="true"></i>
                                        </button>
                                        <div class="filter-menu">
                                            <div class="filter-option active" data-filter="all">All Sections</div>
                                            <div class="filter-option" data-filter="completed">Completed</div>
                                            <div class="filter-option" data-filter="in-progress">In Progress</div>
                                            <div class="filter-option" data-filter="not-started">Not Started</div>
                                        </div>
                                    </div>
                                    
                                    <button class="sort-btn">
                                        <i class="fa fa-sort" aria-hidden="true"></i>
                                        <span>Sort</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="activities-table-container">
                            <table class="professional-activities-table">
                                <thead>
                                    <tr>
                                        <th class="col-activity">ACTIVITY</th>
                                        <th class="col-difficulty">DIFFICULTY</th>
                                        <th class="col-progress">PROGRESS</th>
                                        <th class="col-score">SCORE</th>
                                        <th class="col-status">STATUS</th>
                                        <th class="col-action">ACTION</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {{#section_activities.activities}}
                                    <tr class="activity-row {{#is_completed}}completed{{/is_completed}}{{^is_completed}}{{#has_started}}in-progress{{/has_started}}{{^has_started}}not-started{{/has_started}}{{/is_completed}}">
                                        <td class="activity-cell">
                                            <div class="activity-info">
                                                <div class="activity-icon">
                                                    <i class="fa fa-file-text" aria-hidden="true"></i>
                                                </div>
                                                <div class="activity-details">
                                                    <span class="activity-title">{{name}} {{modname}}</span>
                                                    <span class="activity-type">{{modname}}</span>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="difficulty-cell">
                                            <span class="difficulty-badge beginner">Beginner</span>
                                        </td>
                                        <td class="progress-cell">
                                            <div class="progress-info">
                                                <div class="progress-bar-container">
                                                    <div class="progress-bar">
                                                        <div class="progress-fill" style="width: {{completion_percentage}}%"></div>
                                                    </div>
                                                    <span class="progress-text">{{completion_percentage}}%</span>
                                                </div>
                                                <span class="progress-subtitle">Latest Attempt: {{completion_percentage}}%</span>
                                            </div>
                                        </td>
                                        <td class="score-cell">
                                            <div class="score-info">
                                                <div class="score-bar-container">
                                                    <div class="score-bar">
                                                        <div class="score-fill" style="width: {{completion_percentage}}%"></div>
                                                    </div>
                                                    <span class="score-text">{{score_display}}</span>
                                                </div>
                                                <span class="score-subtitle">Latest Score: {{score_display}}</span>
                                            </div>
                                        </td>
                                        <td class="status-cell">
                                            <div class="status-indicator">
                                                {{#is_completed}}
                                                <div class="status-dot completed"></div>
                                                <span class="status-text">COMPLETED</span>
                                                {{/is_completed}}
                                                {{^is_completed}}
                                                    {{#has_started}}
                                                    <div class="status-dot in-progress"></div>
                                                    <span class="status-text">IN PROGRESS</span>
                                                    {{/has_started}}
                                                    {{^has_started}}
                                                    <div class="status-dot not-started"></div>
                                                    <span class="status-text">NOT STARTED</span>
                                                    {{/has_started}}
                                                {{/is_completed}}
                                            </div>
                                        </td>
                                        <td class="action-cell">
                                            <a href="{{{url}}}" class="action-button">
                                                <i class="fa fa-arrow-right" aria-hidden="true"></i>
                                            </a>
                                        </td>
                                    </tr>
                                    {{/section_activities.activities}}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            {{/custom_section_view}}

            {{^custom_section_view}}
            <!-- Learning Modules Layout -->
            <div class="learning-modules-container">
                <!-- Header Section -->
                <div class="modules-header">
                    <div class="header-content">
                        <div class="header-icon">
                            <div class="icon-container">
                                <i class="fa fa-graduation-cap" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="header-text">
                            <h1>Learning Modules</h1>
                            <p>Interactive, hands-on learning experiences designed for mastery.</p>
                            <div class="header-tabs">
                                <span class="tab-label">MODULES</span>
                                <div class="tab-content">
                                    <span class="tab-main">Interactive</span>
                                    <span class="tab-sub">LEARNING</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="header-controls">
                        <div class="view-controls">
                            <div class="controls-label">VIEW OPTIONS</div>
                            <div class="view-buttons">
                                <button class="view-btn active" data-view="grid" onclick="changeView('grid')">
                                    <i class="fa fa-th" aria-hidden="true"></i>
                                    <span>Grid Card Layout</span>
                                </button>
                                <button class="view-btn" data-view="list" onclick="changeView('list')">
                                    <i class="fa fa-list" aria-hidden="true"></i>
                                    <span>List Linear View</span>
                                </button>
                                <button class="view-btn" data-view="timeline" onclick="changeView('timeline')">
                                    <i class="fa fa-timeline" aria-hidden="true"></i>
                                    <span>Timeline Progress Flow</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="filter-controls">
                            <div class="controls-label">FILTER & SORT</div>
                            <div class="filter-buttons">
                                <div class="filter-dropdown">
                                    <button class="filter-btn">
                                        <i class="fa fa-filter" aria-hidden="true"></i>
                                        <span>All Sections</span>
                                        <i class="fa fa-chevron-down" aria-hidden="true"></i>
                                    </button>
                                    <div class="filter-menu">
                                        <div class="filter-option active" data-filter="all">All Sections</div>
                                        <div class="filter-option" data-filter="completed">Completed</div>
                                        <div class="filter-option" data-filter="in-progress">In Progress</div>
                                        <div class="filter-option" data-filter="not-started">Not Started</div>
                                    </div>
                                </div>
                                
                                <button class="sort-btn">
                                    <i class="fa fa-sort" aria-hidden="true"></i>
                                    <span>By Progress</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Learning Modules Grid -->
                <div class="learning-modules-grid" id="modules-grid">
                    {{#course_sections}}
                    {{#uservisible}}
                    <div class="learning-module-card" data-status="{{#is_completed}}completed{{/is_completed}}{{^is_completed}}{{#has_started}}in-progress{{/has_started}}{{^has_started}}not-started{{/has_started}}{{/is_completed}}" data-section="{{section}}">
                        <!-- Card Header -->
                        <div class="module-card-header">
                            <div class="module-number">
                                <span class="module-num">{{section}}</span>
                            </div>
                            <div class="module-status">
                                {{#is_completed}}
                                <span class="status-badge completed">
                                    <i class="fa fa-check-circle" aria-hidden="true"></i>
                                    Mastered
                                </span>
                                {{/is_completed}}
                                {{^is_completed}}
                                    {{#has_started}}
                                    <span class="status-badge in-progress">
                                        <i class="fa fa-play-circle" aria-hidden="true"></i>
                                        Learning
                                    </span>
                                    {{/has_started}}
                                    {{^has_started}}
                                    <span class="status-badge ready">
                                        <i class="fa fa-rocket" aria-hidden="true"></i>
                                        Ready
                                    </span>
                                    {{/has_started}}
                                {{/is_completed}}
                            </div>
                        </div>

                        <!-- Video/Image Section -->
                        <div class="module-visual-section">
                            <div class="module-image-container">
                                <img src="{{section_image}}" alt="{{name}}" class="module-image">
                                <div class="play-overlay">
                                    <div class="play-button">
                                        <i class="fa fa-play" aria-hidden="true"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Bookmark and Star Icons -->
                            <div class="module-favorites">
                                <button class="favorite-btn bookmark" title="Bookmark">
                                    <i class="fa fa-bookmark" aria-hidden="true"></i>
                                </button>
                                <button class="favorite-btn star" title="Add to Favorites">
                                    <i class="fa fa-star" aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Module Content -->
                        <div class="module-content">
                            <h3 class="module-title">{{name}}</h3>
                            <p class="module-description">{{#summary}}{{summary}}{{/summary}}{{^summary}}Master this section to advance your learning journey.{{/summary}}</p>
                            
                            <!-- Module Statistics Grid -->
                            <div class="module-stats-grid">
                                <div class="stat-item">
                                    <div class="stat-icon">
                                        <i class="fa fa-tasks" aria-hidden="true"></i>
                                    </div>
                                    <div class="stat-content">
                                        <span class="stat-number">{{total_activities}}</span>
                                        <span class="stat-label">ACTIVITIES</span>
                                    </div>
                                </div>
                                
                                <div class="stat-item">
                                    <div class="stat-icon">
                                        <i class="fa fa-clock" aria-hidden="true"></i>
                                    </div>
                                    <div class="stat-content">
                                        <span class="stat-number">2-3h</span>
                                        <span class="stat-label">DURATION</span>
                                    </div>
                                </div>
                                
                                <div class="stat-item">
                                    <div class="stat-icon">
                                        <i class="fa fa-graduation-cap" aria-hidden="true"></i>
                                    </div>
                                    <div class="stat-content">
                                        <span class="stat-number">Beginner</span>
                                        <span class="stat-label">LEVEL</span>
                                    </div>
                                </div>
                                
                                <div class="stat-item">
                                    <div class="stat-icon">
                                        <i class="fa fa-star" aria-hidden="true"></i>
                                            </div>
                                    <div class="stat-content">
                                        <span class="stat-number">{{progress}}%</span>
                                        <span class="stat-label">PROGRESS</span>
                                            </div>
                                            </div>
                                        </div>

                            <!-- Learning Progress Bar -->
                            <div class="learning-progress-section">
                                <div class="progress-header">
                                    <span class="progress-title">Learning Progress</span>
                                    <span class="progress-percentage">{{progress}}%</span>
                                </div>
                                <div class="progress-bar-container">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: {{progress}}%"></div>
                                    </div>
                                </div>
                                        </div>

                            <!-- Action Button -->
                            <div class="module-actions">
                                        {{#is_completed}}
                                <a href="{{{url}}}" class="action-btn review-btn">
                                    <i class="fa fa-eye" aria-hidden="true"></i>
                                    <span>Review Mastery</span>
                                </a>
                                        {{/is_completed}}
                                        {{^is_completed}}
                                            {{#has_started}}
                                    <a href="{{{url}}}" class="action-btn continue-btn" data-section="{{section}}">
                                        <i class="fa fa-play" aria-hidden="true"></i>
                                        <span>Continue Learning</span>
                                            </a>
                                            {{/has_started}}
                                            {{^has_started}}
                                    <a href="{{{url}}}" class="action-btn begin-btn" data-section="{{section}}">
                                        <i class="fa fa-rocket" aria-hidden="true"></i>
                                        <span>Begin Journey</span>
                                            </a>
                                            {{/has_started}}
                                        {{/is_completed}}
                                    </div>

                            <!-- Tags -->
                            <div class="module-tags">
                                <span class="tag">INTERACTIVE</span>
                                <span class="tag">HANDS-ON</span>
                                <span class="tag">PROJECT-BASED</span>
                            </div>

                            <!-- Rating -->
                            <div class="module-rating">
                                <div class="stars">
                                    <i class="fa fa-star" aria-hidden="true"></i>
                                    <i class="fa fa-star" aria-hidden="true"></i>
                                    <i class="fa fa-star" aria-hidden="true"></i>
                                    <i class="fa fa-star" aria-hidden="true"></i>
                                    <i class="fa fa-star-o" aria-hidden="true"></i>
                                </div>
                                <span class="rating-text">4.9/5</span>
                            </div>
                        </div>
                    </div>
                    {{/uservisible}}
                    {{/course_sections}}
                </div>
            </div>
            {{/custom_section_view}}

            {{{ output.activity_navigation }}}
            {{{ output.course_content_footer }}}

            <!-- Main Content Placeholder - Hidden to show only custom layout -->

        </section>
    </div>
</div>

{{> theme_remui/common_end}}