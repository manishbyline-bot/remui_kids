{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.

    Custom Dashboard Template for remui_kids theme
    @package    theme_remui_kids
    @copyright  2025 Kodeit
    @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
}}

{{> theme_remui_kids/common_start}}

<!-- Include the sidebar only for non-admin pages -->
{{^is_admin_page}}{{> theme_remui_kids/riyada_sidebar}}{{/is_admin_page}}

<div id="page-content" class="pb-4 d-print-block">
    <div id="region-main-box">
        <section id="region-main" aria-label="{{#str}}content{{/str}}">
            {{{ output.course_content_header }}}
            {{#headercontent}}
                {{> core/activity_header }}
            {{/headercontent}}
            {{#overflow}}
                <div class="container-fluid tertiary-navigation">
                    <div class="navitem">
                        {{> core/url_select}}
                    </div>
                </div>
            {{/overflow}}

            <!-- Comprehensive Admin Dashboard -->
            <div class="admin-dashboard">
                <!-- Header Section -->
                <div class="dashboard-header">
                    <div class="header-left">
                        <h1 class="dashboard-title">Admin Dashboard</h1>
                        <p class="dashboard-subtitle">Comprehensive system management and analytics</p>
                    </div>
                    <div class="header-right">
                        <div class="quick-actions">
                            <button class="action-btn primary" onclick="window.location.href='{{wwwroot}}/admin/settings.php'">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" />
                                </svg>
                                Settings
                            </button>
                            <button class="action-btn secondary" onclick="window.location.href='{{wwwroot}}/admin/users.php'">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M16,4C18.21,4 20,5.79 20,8C20,10.21 18.21,12 16,12C13.79,12 12,10.21 12,8C12,5.79 13.79,4 16,4M16,14C20.42,14 24,15.79 24,18V20H8V18C8,15.79 11.58,14 16,14M8,4C10.21,4 12,5.79 12,8C12,10.21 10.21,12 8,12C5.79,12 4,10.21 4,8C4,5.79 5.79,4 8,4M8,14C12.42,14 16,15.79 16,18V20H0V18C0,15.79 3.58,14 8,14Z" />
                                </svg>
                                Users
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Main Statistics Grid -->
                <div class="main-stats-grid">
                    <div class="stat-card users">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M16,4C18.21,4 20,5.79 20,8C20,10.21 18.21,12 16,12C13.79,12 12,10.21 12,8C12,5.79 13.79,4 16,4M16,14C20.42,14 24,15.79 24,18V20H8V18C8,15.79 11.58,14 16,14M8,4C10.21,4 12,5.79 12,8C12,10.21 10.21,12 8,12C5.79,12 4,10.21 4,8C4,5.79 5.79,4 8,4M8,14C12.42,14 16,15.79 16,18V20H0V18C0,15.79 3.58,14 8,14Z" />
                            </svg>
                        </div>
                        <div class="stat-value">{{dashboarddata.total_users}}</div>
                        <div class="stat-label">Total Users</div>
                        <div class="stat-subtitle">{{dashboarddata.active_users_30d}} active (30d)</div>
                        <div class="stat-change positive">Real user data</div>
                    </div>

                    <div class="stat-card teachers">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z" />
                            </svg>
                        </div>
                        <div class="stat-value">{{dashboarddata.teachers}}</div>
                        <div class="stat-label">Teachers</div>
                        <div class="stat-subtitle">Teaching staff</div>
                        <div class="stat-change positive">Role assignments: {{dashboarddata.role_verification.teacher_assignments}}</div>
                    </div>

                    <div class="stat-card trainers">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M16,4C18.21,4 20,5.79 20,8C20,10.21 18.21,12 16,12C13.79,12 12,10.21 12,8C12,5.79 13.79,4 16,4M16,14C20.42,14 24,15.79 24,18V20H8V18C8,15.79 11.58,14 16,14M8,4C10.21,4 12,5.79 12,8C12,10.21 10.21,12 8,12C5.79,12 4,10.21 4,8C4,5.79 5.79,4 8,4M8,14C12.42,14 16,15.79 16,18V20H0V18C0,15.79 3.58,14 8,14Z" />
                            </svg>
                        </div>
                        <div class="stat-value">{{dashboarddata.trainers}}</div>
                        <div class="stat-label">Trainers</div>
                        <div class="stat-subtitle">Training staff</div>
                        <div class="stat-change positive">Role assignments: {{dashboarddata.role_verification.trainer_assignments}}</div>
                    </div>

                    <div class="stat-card students">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,3L1,9L12,15L21,10.09V17H23V9M5,13.18V17.18L12,21L19,17.18V13.18L12,17L5,13.18Z" />
                            </svg>
                        </div>
                        <div class="stat-value">{{dashboarddata.students}}</div>
                        <div class="stat-label">Students</div>
                        <div class="stat-subtitle">Active students</div>
                        <div class="stat-change positive">Role assignments: {{dashboarddata.role_verification.student_assignments}}</div>
                    </div>

                    <div class="stat-card courses">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,3L1,9L12,15L21,10.09V17H23V9M5,13.18V17.18L12,21L19,17.18V13.18L12,17L5,13.18Z" />
                            </svg>
                        </div>
                        <div class="stat-value">{{dashboarddata.total_courses}}</div>
                        <div class="stat-label">Courses</div>
                        <div class="stat-subtitle">Active courses</div>
                        <div class="stat-change positive">Real course count</div>
                    </div>

                    <div class="stat-card companies">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,7V3H2V21H22V7H12M6,19H4V17H6V19M6,15H4V13H6V15M6,11H4V9H6V11M6,7H4V5H6V7M10,19H8V17H10V19M10,15H8V13H10V15M10,11H8V9H10V11M10,7H8V5H10V7M20,19H12V17H14V15H12V13H14V11H12V9H20V19M18,11H16V13H18V11M18,15H16V17H18V15Z" />
                            </svg>
                        </div>
                        <div class="stat-value">{{dashboarddata.total_companies}}</div>
                        <div class="stat-label">Schools</div>
                        <div class="stat-subtitle">Active schools</div>
                        <div class="stat-change positive">Real school count</div>
                    </div>

                    <div class="stat-card enrollments">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z" />
                            </svg>
                        </div>
                        <div class="stat-value">{{dashboarddata.total_enrollments}}</div>
                        <div class="stat-label">Enrollments</div>
                        <div class="stat-subtitle">Active enrollments</div>
                        <div class="stat-change positive">Real enrollment data</div>
                    </div>
                </div>

                <!-- Role Breakdown Section -->
                <div class="role-breakdown-section">
                    <h3>Role Assignments Breakdown</h3>
                    <div class="role-breakdown-grid">
                        {{#dashboarddata.role_breakdown}}
                        <div class="role-item">
                            <div class="role-name">{{name}}</div>
                            <div class="role-shortname">{{shortname}}</div>
                            <div class="role-count">{{user_count}} users</div>
                        </div>
                        {{/dashboarddata.role_breakdown}}
                    </div>
                </div>

                <!-- Detailed Analytics Grid -->
                <div class="analytics-grid">
                    <!-- Teacher Analytics -->
                    <div class="analytics-card">
                        <div class="card-header">
                            <h3 class="card-title">Teacher Analytics</h3>
                            <a href="{{wwwroot}}/admin/users.php" class="card-action">View All</a>
                        </div>
                        <div class="teacher-stats">
                            <div class="teacher-stat-item">
                                <span class="teacher-stat-label">Active Teachers:</span>
                                <span class="teacher-stat-value">{{dashboarddata.teachers}}</span>
                            </div>
                            <div class="teacher-stat-item">
                                <span class="teacher-stat-label">Role Assignments:</span>
                                <span class="teacher-stat-value positive">{{dashboarddata.role_verification.teacher_assignments}}</span>
                            </div>
                            <div class="teacher-stat-item">
                                <span class="teacher-stat-label">Active Users:</span>
                                <span class="teacher-stat-value positive">{{dashboarddata.active_users_30d}}</span>
                            </div>
                            <div class="teacher-stat-item">
                                <span class="teacher-stat-label">Completion Rate:</span>
                                <span class="teacher-stat-value positive">{{dashboarddata.completion_rate}}%</span>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill blue" style="width: 85%"></div>
                        </div>
                        <div style="text-align: center; margin-top: 8px; font-size: 0.75rem; color: #6b7280;">
                            Teacher Certification Progress
                        </div>
                    </div>

                    <!-- Trainer Analytics -->
                    <div class="analytics-card">
                        <div class="card-header">
                            <h3 class="card-title">Trainer Analytics</h3>
                            <a href="{{wwwroot}}/admin/users.php" class="card-action">View All</a>
                        </div>
                        <div class="teacher-stats">
                            <div class="teacher-stat-item">
                                <span class="teacher-stat-label">Active Trainers:</span>
                                <span class="teacher-stat-value">{{dashboarddata.trainers}}</span>
                            </div>
                            <div class="teacher-stat-item">
                                <span class="teacher-stat-label">Role Assignments:</span>
                                <span class="teacher-stat-value positive">{{dashboarddata.role_verification.trainer_assignments}}</span>
                            </div>
                            <div class="teacher-stat-item">
                                <span class="teacher-stat-label">Active Users:</span>
                                <span class="teacher-stat-value positive">{{dashboarddata.active_users_30d}}</span>
                            </div>
                            <div class="teacher-stat-item">
                                <span class="teacher-stat-label">Completion Rate:</span>
                                <span class="teacher-stat-value positive">{{dashboarddata.completion_rate}}%</span>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill green" style="width: 75%"></div>
                        </div>
                        <div style="text-align: center; margin-top: 8px; font-size: 0.75rem; color: #6b7280;">
                            Trainer Certification Progress
                        </div>
                    </div>

                    <!-- Course Analytics -->
                    <div class="analytics-card">
                        <div class="card-header">
                            <h3 class="card-title">Course Analytics</h3>
                            <a href="{{wwwroot}}/course/index.php" class="card-action">Manage</a>
                        </div>
                        <div class="course-list">
                            {{#dashboarddata.top_courses}}
                            <div class="course-item">
                                <div class="course-name">{{fullname}}</div>
                                <div class="course-shortname">{{shortname}}</div>
                                <div class="course-stats">
                                    <div class="course-enrollments">{{enrollments}}</div>
                                    <div class="course-completion">{{completion_rate}}%</div>
                                </div>
                            </div>
                            {{/dashboarddata.top_courses}}
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill green" style="width: {{dashboarddata.completion_rate}}%"></div>
                        </div>
                        <div style="text-align: center; margin-top: 8px; font-size: 0.75rem; color: #6b7280;">
                            Overall Completion Rate: {{dashboarddata.completion_rate}}%
                        </div>
                    </div>

                    <!-- Student Analytics -->
                    <div class="analytics-card">
                        <div class="card-header">
                            <h3 class="card-title">Student Analytics</h3>
                            <a href="{{wwwroot}}/admin/users.php" class="card-action">View All</a>
                        </div>
                        <div class="student-breakdown">
                            <div class="student-category">
                                <div class="student-category-value">{{dashboarddata.students}}</div>
                                <div class="student-category-label">Total Students</div>
                            </div>
                            <div class="student-category">
                                <div class="student-category-value">{{dashboarddata.active_users}}</div>
                                <div class="student-category-label">Active This Month</div>
                            </div>
                        </div>
                        <div class="teacher-stats">
                            <div class="teacher-stat-item">
                                <span class="teacher-stat-label">Completion Rate:</span>
                                <span class="teacher-stat-value positive">{{dashboarddata.completion_rate}}%</span>
                            </div>
                            <div class="teacher-stat-item">
                                <span class="teacher-stat-label">Avg. Progress:</span>
                                <span class="teacher-stat-value positive">68%</span>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill purple" style="width: 68%"></div>
                        </div>
                        <div style="text-align: center; margin-top: 8px; font-size: 0.75rem; color: #6b7280;">
                            Average Student Progress
                        </div>
                    </div>
                </div>

                <!-- Management Tools Grid -->
                <div class="management-tools">
                    <div class="tool-card">
                        <div class="tool-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M16,4C18.21,4 20,5.79 20,8C20,10.21 18.21,12 16,12C13.79,12 12,10.21 12,8C12,5.79 13.79,4 16,4M16,14C20.42,14 24,15.79 24,18V20H8V18C8,15.79 11.58,14 16,14M8,4C10.21,4 12,5.79 12,8C12,10.21 10.21,12 8,12C5.79,12 4,10.21 4,8C4,5.79 5.79,4 8,4M8,14C12.42,14 16,15.79 16,18V20H0V18C0,15.79 3.58,14 8,14Z" />
                            </svg>
                        </div>
                        <div class="tool-title">User Management</div>
                        <div class="tool-description">Manage users, roles, and permissions</div>
                        <div class="tool-stats">
                            <div class="tool-stat">
                                <div class="tool-stat-value">{{dashboarddata.total_users}}</div>
                                <div class="tool-stat-label">Total Users</div>
                            </div>
                            <div class="tool-stat">
                                <div class="tool-stat-value">{{dashboarddata.teachers}}</div>
                                <div class="tool-stat-label">Teachers</div>
                            </div>
                        </div>
                        <a href="{{wwwroot}}/admin/user.php" class="tool-link">Manage Users</a>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,3L1,9L12,15L21,10.09V17H23V9M5,13.18V17.18L12,21L19,17.18V13.18L12,17L5,13.18Z" />
                            </svg>
                        </div>
                        <div class="tool-title">Course Management</div>
                        <div class="tool-description">Create and manage courses</div>
                        <div class="tool-stats">
                            <div class="tool-stat">
                                <div class="tool-stat-value">{{dashboarddata.total_courses}}</div>
                                <div class="tool-stat-label">Courses</div>
                            </div>
                            <div class="tool-stat">
                                <div class="tool-stat-value">{{dashboarddata.total_enrollments}}</div>
                                <div class="tool-stat-label">Enrollments</div>
                            </div>
                        </div>
                        <a href="{{wwwroot}}/course/index.php" class="tool-link">Manage Courses</a>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,7V3H2V21H22V7H12M6,19H4V17H6V19M6,15H4V13H6V15M6,11H4V9H6V11M6,7H4V5H6V7M10,19H8V17H10V19M10,15H8V13H10V15M10,11H8V9H10V11M10,7H8V5H10V7M20,19H12V17H14V15H12V13H14V11H12V9H20V19M18,11H16V13H18V11M18,15H16V17H18V15Z" />
                            </svg>
                        </div>
                        <div class="tool-title">School Management</div>
                        <div class="tool-description">Manage IOMAD schools and departments</div>
                        <div class="tool-stats">
                            <div class="tool-stat">
                                <div class="tool-stat-value">{{dashboarddata.total_companies}}</div>
                                <div class="tool-stat-label">Schools</div>
                            </div>
                            <div class="tool-stat">
                                <div class="tool-stat-value">{{dashboarddata.total_departments}}</div>
                                <div class="tool-stat-label">Departments</div>
                            </div>
                        </div>
                        <a href="{{wwwroot}}/local/iomad/index.php" class="tool-link">Manage Schools</a>
                    </div>

                    <div class="tool-card">
                        <div class="tool-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z" />
                            </svg>
                        </div>
                        <div class="tool-title">Reports & Analytics</div>
                        <div class="tool-description">View system reports and analytics</div>
                        <div class="tool-stats">
                            <div class="tool-stat">
                                <div class="tool-stat-value">{{dashboarddata.completion_rate}}%</div>
                                <div class="tool-stat-label">Completion</div>
                            </div>
                            <div class="tool-stat">
                                <div class="tool-stat-value">{{dashboarddata.active_users}}</div>
                                <div class="tool-stat-label">Active Users</div>
                            </div>
                        </div>
                        <a href="{{wwwroot}}/admin/reports.php" class="tool-link">View Reports</a>
                    </div>
                </div>

                <!-- Quick Actions Grid -->
                <div class="quick-actions-grid">
                    <a href="{{wwwroot}}/admin/user.php" class="quick-action-card">
                        <div class="quick-action-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M16,4C18.21,4 20,5.79 20,8C20,10.21 18.21,12 16,12C13.79,12 12,10.21 12,8C12,5.79 13.79,4 16,4M16,14C20.42,14 24,15.79 24,18V20H8V18C8,15.79 11.58,14 16,14M8,4C10.21,4 12,5.79 12,8C12,10.21 10.21,12 8,12C5.79,12 4,10.21 4,8C4,5.79 5.79,4 8,4M8,14C12.42,14 16,15.79 16,18V20H0V18C0,15.79 3.58,14 8,14Z" />
                            </svg>
                        </div>
                        <div class="quick-action-title">Add User</div>
                        <div class="quick-action-description">Create new user</div>
                    </a>

                    <a href="{{wwwroot}}/course/edit.php" class="quick-action-card">
                        <div class="quick-action-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,3L1,9L12,15L21,10.09V17H23V9M5,13.18V17.18L12,21L19,17.18V13.18L12,17L5,13.18Z" />
                            </svg>
                        </div>
                        <div class="quick-action-title">Create Course</div>
                        <div class="quick-action-description">Add new course</div>
                    </a>

                    <a href="{{wwwroot}}/admin/plugins.php" class="quick-action-card">
                        <div class="quick-action-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z" />
                            </svg>
                        </div>
                        <div class="quick-action-title">Plugins</div>
                        <div class="quick-action-description">Manage plugins</div>
                    </a>

                    <a href="{{wwwroot}}/admin/settings.php" class="quick-action-card">
                        <div class="quick-action-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" />
                            </svg>
                        </div>
                        <div class="quick-action-title">Settings</div>
                        <div class="quick-action-description">System settings</div>
                    </a>

                    <a href="{{wwwroot}}/admin/reports.php" class="quick-action-card">
                        <div class="quick-action-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M22,21H2V3H4V19H6V17H10V19H12V16H16V19H18V17H22V21Z" />
                            </svg>
                        </div>
                        <div class="quick-action-title">Reports</div>
                        <div class="quick-action-description">View reports</div>
                    </a>

                    <a href="{{wwwroot}}/local/iomad/index.php" class="quick-action-card">
                        <div class="quick-action-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,7V3H2V21H22V7H12M6,19H4V17H6V19M6,15H4V13H6V15M6,11H4V9H6V11M6,7H4V5H6V7M10,19H8V17H10V19M10,15H8V13H10V15M10,11H8V9H10V11M10,7H8V5H10V7M20,19H12V17H14V15H12V13H14V11H12V9H20V19M18,11H16V13H18V11M18,15H16V17H18V15Z" />
                            </svg>
                        </div>
                        <div class="quick-action-title">IOMAD</div>
                        <div class="quick-action-description">Company management</div>
                    </a>
                </div>

                <!-- System Status -->
                
            </div>

            {{{ output.activity_navigation }}}
            {{{ output.course_content_footer }}}
        </section>
    </div>
</div>

    <link rel="stylesheet" href="{{wwwroot}}/theme/remui_kids/style/admin-dashboard.css?v={{timestamp}}">
    
    <script>
    // Force cache refresh
    console.log('Dashboard template loaded with sidebar');
    </script>
    
    <style>
    /* Hide Moodle's default main content completely */
    .moodle-main-content {
        display: none !important;
        visibility: hidden !important;
        position: absolute !important;
        left: -9999px !important;
        width: 0 !important;
        height: 0 !important;
        overflow: hidden !important;
        opacity: 0 !important;
    }
    
    /* Force sidebar styles to be applied */
    #riyada-sidebar {
        position: fixed !important;
        top: 60px !important;
        left: 0 !important;
        width: 280px !important;
        height: calc(100vh - 60px) !important;
        background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%) !important;
        z-index: 999 !important;
        overflow-y: auto !important;
        transition: transform 0.3s ease !important;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1) !important;
        display: flex !important;
        flex-direction: column !important;
        border-right: 1px solid #e5e7eb !important;
    }
    
    .riyada-sidebar-nav {
        padding: 20px 0 !important;
        flex: 1 !important;
    }
    
    .riyada-nav-section {
        margin-bottom: 32px !important;
    }
    
    .riyada-nav-section-title {
        color: #6b7280 !important;
        font-size: 0.75rem !important;
        font-weight: 600 !important;
        text-transform: uppercase !important;
        letter-spacing: 0.8px !important;
        padding: 0 24px 16px !important;
        margin-bottom: 8px !important;
        border-bottom: 1px solid #e5e7eb !important;
    }
    
    .riyada-nav-list {
        list-style: none !important;
        padding: 0 !important;
        margin: 0 !important;
    }
    
    .riyada-nav-item {
        margin: 0 !important;
    }
    
    .riyada-nav-link {
        display: flex !important;
        align-items: center !important;
        padding: 14px 24px !important;
        color: #374151 !important;
        text-decoration: none !important;
        transition: all 0.2s ease !important;
        position: relative !important;
        border-left: 3px solid transparent !important;
        font-size: 0.9rem !important;
        font-weight: 500 !important;
    }
    
    .riyada-nav-link:hover {
        background: rgba(59, 130, 246, 0.08) !important;
        color: #1f2937 !important;
        border-left-color: #3b82f6 !important;
    }
    
    .riyada-nav-link.active {
        background: rgba(59, 130, 246, 0.12) !important;
        color: #1f2937 !important;
        border-left-color: #3b82f6 !important;
        font-weight: 600 !important;
    }
    
    .riyada-nav-icon {
        font-size: 1.1rem !important;
        margin-right: 14px !important;
        width: 20px !important;
        text-align: center !important;
        opacity: 0.9 !important;
    }
    
    .riyada-nav-text {
        font-size: 0.9rem !important;
        font-weight: inherit !important;
        flex: 1 !important;
    }
    
    .riyada-nav-indicator {
        width: 6px !important;
        height: 6px !important;
        background: #3b82f6 !important;
        border-radius: 50% !important;
        opacity: 0 !important;
        transition: opacity 0.2s ease !important;
        margin-left: auto !important;
    }
    
    .riyada-nav-link.active .riyada-nav-indicator {
        opacity: 1 !important;
    }
    
    
    /* Adjust page content when sidebar is present */
    body.has-sidebar {
        margin-left: 280px !important;
    }
    
    /* Make dashboard use full width */
    .dashboard-content {
        width: 100% !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 0 !important;
    }
    
    /* Remove any container constraints */
    .container, .container-fluid {
        max-width: none !important;
        width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
    }
    
    /* Full width for main content area */
    #region-main {
        width: 100% !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 0 !important;
    }
    
    /* Remove any wrapper constraints */
    .wrapper, .page-wrapper {
        max-width: none !important;
        width: 100% !important;
    }
    
    /* Full width for page content */
    #page-content {
        width: 100% !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 0 !important;
    }
    
    /* Full width for region main box */
    #region-main-box {
        width: 100% !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 0 !important;
    }
    
    /* Remove any grid constraints */
    .row {
        margin: 0 !important;
        width: 100% !important;
    }
    
    .col, .col-12, .col-md-12, .col-lg-12 {
        width: 100% !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 0 !important;
    }
    
    /* Hide footer on all pages */
    footer, .footer, #page-footer, .page-footer {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        overflow: hidden !important;
    }
    
    /* Remove footer space */
    body {
        padding-bottom: 0 !important;
        margin-bottom: 0 !important;
    }
    
    /* Hide all possible footer elements */
    .site-footer, .main-footer, .footer-content, .footer-wrapper,
    .page-footer-content, .footer-links, .footer-info,
    .copyright, .footer-text, .footer-bottom {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        overflow: hidden !important;
    }
    
    /* Hide Custom Pages footer section */
    .custom-pages, .custom-pages-footer, .footer-custom-pages,
    .footer-section, .footer-menu, .footer-navigation,
    .footer-links-section, .footer-menu-section {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        overflow: hidden !important;
    }
    
    /* Hide specific footer content */
    .footer-about, .footer-faq, .footer-privacy,
    .footer-university, .footer-custom-content {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        overflow: hidden !important;
    }
    
    /* Remove any footer margins/padding from main content */
    .main-content, .page-content, #page-content {
        margin-bottom: 0 !important;
        padding-bottom: 0 !important;
    }
    
    /* Hide any element containing "Custom Pages" text */
    *:contains("Custom Pages"), *:contains("About Us"), *:contains("FAQ"), *:contains("Privacy Policy") {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        overflow: hidden !important;
    }
    
    /* Hide any dark blue footer sections */
    [style*="background-color: #1e3a8a"], [style*="background: #1e3a8a"],
    [style*="background-color: darkblue"], [style*="background: darkblue"] {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        overflow: hidden !important;
    }
    
    /* Hide any footer-like sections at bottom of page */
    .page-bottom, .bottom-section, .page-end, .content-end {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        overflow: hidden !important;
    }
    
    /* Complete footer removal for entire project */
    footer, .footer, #page-footer, .page-footer, .site-footer, .main-footer,
    .footer-content, .footer-wrapper, .page-footer-content, .footer-links,
    .footer-info, .copyright, .footer-text, .footer-bottom, .custom-pages,
    .custom-pages-footer, .footer-custom-pages, .footer-section, .footer-menu,
    .footer-navigation, .footer-links-section, .footer-menu-section,
    .footer-about, .footer-faq, .footer-privacy, .footer-university,
    .footer-custom-content, .page-bottom, .bottom-section, .page-end,
    .content-end, .footer-main, .footer-container, .footer-inner,
    .footer-top, .footer-middle, .footer-bottom-section, .footer-copyright,
    .footer-social, .footer-newsletter, .footer-contact, .footer-legal,
    .footer-disclaimer, .footer-terms, .footer-conditions, .footer-policy {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        overflow: hidden !important;
        position: absolute !important;
        left: -9999px !important;
        width: 0 !important;
        margin: 0 !important;
        padding: 0 !important;
    }
    
    /* Hide any element that might contain footer content */
    div[class*="footer"], div[id*="footer"], section[class*="footer"],
    section[id*="footer"], aside[class*="footer"], aside[id*="footer"],
    nav[class*="footer"], nav[id*="footer"] {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        overflow: hidden !important;
    }
    
    /* Fix site administration page layout */
    .path-admin .has-sidebar {
        margin-left: 0 !important;
    }
    
    .path-admin #riyada-sidebar {
        display: none !important;
        visibility: hidden !important;
        position: absolute !important;
        left: -9999px !important;
    }
    
    /* Ensure admin page content is not affected by sidebar */
    .path-admin .admin-dashboard {
        margin-left: 0 !important;
        max-width: 100% !important;
    }
    
    /* Hide sidebar on all admin pages */
    body.path-admin #riyada-sidebar {
        display: none !important;
        visibility: hidden !important;
        position: absolute !important;
        left: -9999px !important;
        width: 0 !important;
        height: 0 !important;
        overflow: hidden !important;
    }
    
    /* Reset body margin for admin pages */
    body.path-admin.has-sidebar {
        margin-left: 0 !important;
    }
    
    /* Ensure admin page layout is not affected */
    body.path-admin {
        margin-left: 0 !important;
    }
    
    /* Ensure navigation bar text is visible */
    .navbar, .navbar-nav, .navbar-brand, .navbar-text {
        color: #1f2937 !important;
        z-index: 1000 !important;
    }
    
    .navbar a, .navbar-nav a, .navbar-brand a {
        color: #1f2937 !important;
    }
    
    .navbar .nav-link {
        color: #1f2937 !important;
    }
    
    .navbar .dropdown-menu {
        background: white !important;
        border: 1px solid #e5e7eb !important;
    }
    
    .navbar .dropdown-item {
        color: #374151 !important;
    }
    
    .navbar .dropdown-item:hover {
        background: #f8fafc !important;
        color: #1f2937 !important;
    }
    
    /* Fix site administration specific issues */
    .path-admin .region-main {
        margin-left: 0 !important;
        width: 100% !important;
    }
    
    .path-admin .admin-content {
        margin-left: 0 !important;
        width: 100% !important;
    }
    
    .path-admin .admin-nav {
        margin-left: 0 !important;
        width: 100% !important;
    }
    
    .path-admin .admin-tabs {
        margin-left: 0 !important;
        width: 100% !important;
    }
    
    .path-admin .admin-search {
        margin-left: 0 !important;
        width: 100% !important;
    }
    
    /* Ensure admin forms work properly */
    .path-admin form {
        margin-left: 0 !important;
        width: 100% !important;
    }
    
    .path-admin .form-group {
        margin-left: 0 !important;
        width: 100% !important;
    }
    
    .path-admin .btn {
        margin-left: 0 !important;
    }
    
    @media (max-width: 768px) {
        body.has-sidebar {
            margin-left: 0 !important;
        }
        
        #riyada-sidebar {
            top: 60px !important;
            height: calc(100vh - 60px) !important;
            transform: translateX(-100%) !important;
        }
        
        #riyada-sidebar.mobile-open {
            transform: translateX(0) !important;
        }
    }
    </style>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize admin dashboard
        initializeAdminDashboard();
        
        // Initialize sidebar
        initializeSidebar();
    });

    function initializeAdminDashboard() {
        // Add smooth animations
        addAnimations();
        
        // Add hover effects to cards
        addCardHoverEffects();
    }

    function addAnimations() {
        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            @keyframes slideInLeft {
                from {
                    opacity: 0;
                    transform: translateX(-20px);
                }
                to {
                    opacity: 1;
                    transform: translateX(0);
                }
            }
            
            .overview-card {
                animation: fadeInUp 0.6s ease-out;
            }
            
            .tool-card {
                animation: slideInLeft 0.8s ease-out;
            }
            
            .action-card {
                animation: fadeInUp 0.4s ease-out;
            }
            
            .overview-card:nth-child(1) { animation-delay: 0.1s; }
            .overview-card:nth-child(2) { animation-delay: 0.2s; }
            .overview-card:nth-child(3) { animation-delay: 0.3s; }
            .overview-card:nth-child(4) { animation-delay: 0.4s; }
            
            .tool-card:nth-child(1) { animation-delay: 0.5s; }
            .tool-card:nth-child(2) { animation-delay: 0.6s; }
            .tool-card:nth-child(3) { animation-delay: 0.7s; }
            .tool-card:nth-child(4) { animation-delay: 0.8s; }
            
            .action-card:nth-child(1) { animation-delay: 0.9s; }
            .action-card:nth-child(2) { animation-delay: 1.0s; }
            .action-card:nth-child(3) { animation-delay: 1.1s; }
            .action-card:nth-child(4) { animation-delay: 1.2s; }
        `;
        document.head.appendChild(style);
    }

    function addCardHoverEffects() {
        // Add hover effects to overview cards
        const overviewCards = document.querySelectorAll('.overview-card');
        overviewCards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-4px)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });

        // Add hover effects to tool cards
        const toolCards = document.querySelectorAll('.tool-card');
        toolCards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-4px)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });

        // Add hover effects to action cards
        const actionCards = document.querySelectorAll('.action-card');
        actionCards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-2px)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });
    }
    
    function initializeSidebar() {
        // Check if we're on an admin page
        const isAdminPage = document.body.classList.contains('path-admin') || 
                           window.location.pathname.includes('/admin/') ||
                           window.location.pathname.includes('admin');
        
        if (isAdminPage) {
            // Remove sidebar completely from admin pages
            const sidebar = document.querySelector('#riyada-sidebar');
            if (sidebar) {
                sidebar.style.display = 'none';
                sidebar.style.visibility = 'hidden';
                sidebar.style.position = 'absolute';
                sidebar.style.left = '-9999px';
                sidebar.style.width = '0';
                sidebar.style.height = '0';
                sidebar.style.overflow = 'hidden';
            }
            
            // Remove sidebar class from body
            document.body.classList.remove('has-sidebar');
            document.body.style.marginLeft = '0';
            return;
        }
        
        // Add sidebar class to body for non-admin pages
        document.body.classList.add('has-sidebar');
        
        // Mobile sidebar functionality
        if (window.innerWidth <= 768) {
            createMobileHeader();
        }
        
        window.addEventListener('resize', function() {
            if (window.innerWidth <= 768) {
                createMobileHeader();
            } else {
                removeMobileHeader();
            }
        });
        
        // Initialize sidebar toggle functionality
        const fabBtn = document.querySelector('.riyada-fab-btn');
        if (fabBtn) {
            fabBtn.addEventListener('click', toggleSidebar);
        }
    }
    
    function createMobileHeader() {
        if (document.querySelector('.mobile-header')) return;
        
        const mobileHeader = document.createElement('div');
        mobileHeader.className = 'mobile-header';
        mobileHeader.innerHTML = `
            <button class="hamburger-menu" onclick="toggleSidebar()">
                ☰
            </button>
            <div class="mobile-logo">Dashboard</div>
        `;
        
        // Add mobile header styles
        const style = document.createElement('style');
        style.textContent = `
            .mobile-header {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                height: 60px;
                background: #1e293b;
                color: white;
                display: flex;
                align-items: center;
                padding: 0 20px;
                z-index: 1002;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            
            .hamburger-menu {
                background: none;
                border: none;
                color: white;
                font-size: 1.5rem;
                cursor: pointer;
                padding: 8px;
                margin-right: 15px;
            }
            
            .mobile-logo {
                font-size: 1.2rem;
                font-weight: 600;
            }
        `;
        document.head.appendChild(style);
        
        document.body.insertBefore(mobileHeader, document.body.firstChild);
        
        const overlay = document.createElement('div');
        overlay.className = 'sidebar-overlay';
        overlay.onclick = closeSidebar;
        document.body.appendChild(overlay);
    }
    
    function removeMobileHeader() {
        const mobileHeader = document.querySelector('.mobile-header');
        const overlay = document.querySelector('.sidebar-overlay');
        
        if (mobileHeader) mobileHeader.remove();
        if (overlay) overlay.remove();
    }
    
    function toggleSidebar() {
        const sidebar = document.querySelector('#riyada-sidebar');
        const overlay = document.querySelector('.sidebar-overlay');
        
        if (sidebar && overlay) {
            sidebar.classList.toggle('mobile-open');
            overlay.classList.toggle('show');
        }
    }
    
    function closeSidebar() {
        const sidebar = document.querySelector('#riyada-sidebar');
        const overlay = document.querySelector('.sidebar-overlay');
        
        if (sidebar && overlay) {
            sidebar.classList.remove('mobile-open');
            overlay.classList.remove('show');
        }
    }
    </script>

{{> theme_remui_kids/common_end}}
