{{!
    Trainee Certifications Template
    
    @template theme_remui_kids/trainee_certifications
    
    Display and download earned certificates
}}

<!-- Include certifications CSS -->
<link rel="stylesheet" href="{{wwwroot}}/theme/remui_kids/style/trainee_certifications.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<div class="certifications-container">
    <!-- Header Section -->
    <div class="certifications-header">
        <div class="header-content">
            <a href="{{back_url}}" class="back-button">
                <i class="fas fa-arrow-left"></i>
                <span>Back to Dashboard</span>
            </a>
            <h1 class="page-title">
                <i class="fas fa-certificate"></i>
                My Certifications
            </h1>
            <p class="page-subtitle">View and download your earned certificates and achievements</p>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="cert-stats-row">
        <div class="cert-stat-card total-card">
            <div class="stat-icon">
                <i class="fas fa-award"></i>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{total_certificates}}</div>
                <div class="stat-label">Total Certificates</div>
            </div>
        </div>
        
        <div class="cert-stat-card active-card">
            <div class="stat-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{active_certificates}}</div>
                <div class="stat-label">Active Certificates</div>
            </div>
        </div>
        
        <div class="cert-stat-card year-card">
            <div class="stat-icon">
                <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{certificates_this_year}}</div>
                <div class="stat-label">Earned This Year</div>
            </div>
        </div>
        
        <div class="cert-stat-card expired-card">
            <div class="stat-icon">
                <i class="fas fa-clock"></i>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{expired_certificates}}</div>
                <div class="stat-label">Expired</div>
            </div>
        </div>
    </div>

    <!-- Certificates Grid -->
    {{#has_certificates}}
    <div class="certificates-section">
        <div class="section-header">
            <h2><i class="fas fa-graduation-cap"></i> Your Achievements</h2>
            <p class="section-subtitle">Click on any certificate to download</p>
        </div>

        <div class="certificates-grid">
            {{#certificates}}
            <div class="certificate-card {{#is_expired}}expired{{/is_expired}} {{#is_active}}active{{/is_active}}">
                <div class="certificate-badge">
                    <img src="{{badge_image}}" alt="{{name}}" class="badge-image">
                    {{#is_expired}}
                    <div class="expired-overlay">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>Expired</span>
                    </div>
                    {{/is_expired}}
                </div>

                <div class="certificate-content">
                    <h3 class="certificate-title">{{name}}</h3>
                    
                    {{#description}}
                    <p class="certificate-description">{{description}}</p>
                    {{/description}}

                    <div class="certificate-details">
                        <div class="detail-item">
                            <i class="fas fa-calendar-check"></i>
                            <span>Issued: {{issued_date}}</span>
                        </div>
                        
                        {{#has_course}}
                        <div class="detail-item">
                            <i class="fas fa-book"></i>
                            <span>{{course_name}}</span>
                        </div>
                        {{/has_course}}
                        
                        <div class="detail-item expiry-info">
                            <i class="fas fa-hourglass-half"></i>
                            <span>{{expiry_status}}</span>
                        </div>
                        
                        <div class="detail-item">
                            <i class="fas fa-id-card"></i>
                            <span>ID: {{certificate_id}}</span>
                        </div>
                    </div>

                    {{#has_competencies}}
                    <div class="competencies-section">
                        <div class="competencies-label">
                            <i class="fas fa-star"></i>
                            <span>Competencies Earned:</span>
                        </div>
                        <div class="competencies-list">
                            {{#competencies}}
                            <span class="competency-tag">{{name}}</span>
                            {{/competencies}}
                        </div>
                    </div>
                    {{/has_competencies}}

                    <div class="certificate-actions">
                        <a href="{{download_url}}" class="btn-download" title="Download Certificate">
                            <i class="fas fa-download"></i>
                            <span>Download PDF</span>
                        </a>
                        <a href="{{verification_url}}" target="_blank" class="btn-verify" title="Verify Certificate">
                            <i class="fas fa-check-circle"></i>
                            <span>Verify</span>
                        </a>
                        <button class="btn-share" title="Share Certificate" onclick="shareCertificate('{{name}}', '{{verification_url}}')">
                            <i class="fas fa-share-alt"></i>
                            <span>Share</span>
                        </button>
                    </div>
                </div>
            </div>
            {{/certificates}}
        </div>
    </div>
    {{/has_certificates}}

    {{^has_certificates}}
    <div class="no-certificates">
        <div class="no-certificates-icon">
            <i class="fas fa-certificate"></i>
        </div>
        <h3>No Certificates Yet</h3>
        <p>Complete courses and earn badges to receive certificates. Keep learning!</p>
        <div class="action-buttons">
            <a href="{{wwwroot}}/course/index.php" class="btn-browse">
                <i class="fas fa-search"></i>
                Browse Courses
            </a>
            <a href="{{wwwroot}}/badges/mybadges.php" class="btn-badges">
                <i class="fas fa-medal"></i>
                View All Badges
            </a>
        </div>
    </div>
    {{/has_certificates}}
</div>

<!-- Share Modal -->
<div id="shareModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h3><i class="fas fa-share-alt"></i> Share Certificate</h3>
        <div class="share-options">
            <button class="share-btn linkedin" onclick="shareToLinkedIn()">
                <i class="fab fa-linkedin"></i>
                Share on LinkedIn
            </button>
            <button class="share-btn twitter" onclick="shareToTwitter()">
                <i class="fab fa-twitter"></i>
                Share on Twitter
            </button>
            <button class="share-btn facebook" onclick="shareToFacebook()">
                <i class="fab fa-facebook"></i>
                Share on Facebook
            </button>
            <button class="share-btn copy" onclick="copyLink()">
                <i class="fas fa-link"></i>
                Copy Link
            </button>
        </div>
    </div>
</div>

<script>
let currentShareUrl = '';
let currentShareTitle = '';

function shareCertificate(title, url) {
    currentShareTitle = title;
    currentShareUrl = url;
    document.getElementById('shareModal').style.display = 'block';
}

function shareToLinkedIn() {
    const url = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(currentShareUrl)}`;
    window.open(url, '_blank', 'width=600,height=400');
}

function shareToTwitter() {
    const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent('I earned: ' + currentShareTitle)}&url=${encodeURIComponent(currentShareUrl)}`;
    window.open(url, '_blank', 'width=600,height=400');
}

function shareToFacebook() {
    const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(currentShareUrl)}`;
    window.open(url, '_blank', 'width=600,height=400');
}

function copyLink() {
    navigator.clipboard.writeText(currentShareUrl).then(function() {
        alert('Link copied to clipboard!');
    });
}

// Close modal
document.querySelector('.close').onclick = function() {
    document.getElementById('shareModal').style.display = 'none';
}

window.onclick = function(event) {
    const modal = document.getElementById('shareModal');
    if (event.target == modal) {
        modal.style.display = 'none';
    }
}

document.addEventListener('DOMContentLoaded', function() {
    // Add entrance animations
    const statCards = document.querySelectorAll('.cert-stat-card');
    statCards.forEach((card, index) => {
        setTimeout(() => {
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 100);
    });
    
    // Add hover effects to certificate cards
    const certCards = document.querySelectorAll('.certificate-card');
    certCards.forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-10px)';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
        });
    });
});
</script>

